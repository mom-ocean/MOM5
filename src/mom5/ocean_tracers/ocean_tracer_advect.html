<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=EUC-JP">
<title>Module ocean_tracer_advect_mod</title>
<link type="text/css" href="http://data1.gfdl.noaa.gov/~fms/style/docbook.css" rel="stylesheet">
<STYLE TYPE="text/css">
          .fixed {
            font-size:medium;
            font-family:monospace;
            border-style:none;
            border-width:0.1em;
            padding:0.1em;
            color:#663366;
          }
        </STYLE>
</head>
<body>
<a name="TOP"></a><font class="header" size="1"><a href="#PUBLIC INTERFACE">PUBLIC INTERFACE </a>

          ~ <a href="#PUBLIC ROUTINES">PUBLIC ROUTINES </a>
	    ~ <a href="#NAMELIST">NAMELIST </a></font>
<hr>
<h2>Module ocean_tracer_advect_mod</h2>
<a name="HEADER"></a>
<!-- BEGIN HEADER -->
<div>
<b>Contact:&nbsp;</b><a href="mailto:GFDL.Climate.Model.Info@noaa.gov"> Matt Harrison 
</a>,&nbsp;
    <a href="mailto:GFDL.Climate.Model.Info@noaa.gov"> S. M. Griffies 
</a>,&nbsp;
    <a href="mailto:GFDL.Climate.Model.Info@noaa.gov"> John Dunne 
</a>,&nbsp;
    <a href="mailto:GFDL.Climate.Model.Info@noaa.gov"> Alistair Adcroft 
</a>
<br>
<b>Reviewers:&nbsp;</b>
<br>
<b>Change History:&nbsp;</b><a href="http://cobweb.gfdl.noaa.gov/fms-cgi-bin/viewcvs/FMS/ocean/mom5/ocean_tracers">WebCVS Log</a>
<br>
<br>
</div>
<!-- END HEADER -->
<a name="OVERVIEW"></a>
<hr>
<h4>OVERVIEW</h4>
<!-- BEGIN OVERVIEW -->
<p class="text">
 This module computes thickness weighted tracer advection tendencies. 
</p>
<!-- END OVERVIEW -->
<a name="DESCRIPTION"></a>
<!-- BEGIN DESCRIPTION -->
<div>
 This module computes thickness weighted tracer advection tendencies
 using a variety of advection schemes.  
</div>
<br>
<!-- END DESCRIPTION -->
<a name="OTHER MODULES USED"></a>
<hr>
<h4>OTHER MODULES USED</h4>
<!-- BEGIN OTHER MODULES USED -->
<div>
<pre>        constants_mod<br>     diag_manager_mod<br>              fms_mod<br>           fms_io_mod<br>      mpp_domains_mod<br>              mpp_mod<br>    ocean_domains_mod<br>        ocean_obc_mod<br> ocean_parameters_mod<br>      ocean_topog_mod<br>ocean_tracer_util_mod<br>      ocean_types_mod<br>  ocean_workspace_mod</pre>
</div>
<!-- END OTHER MODULES USED -->
<!-- BEGIN PUBLIC INTERFACE -->
<a name="PUBLIC INTERFACE"></a>
<hr>
<h4>PUBLIC INTERFACE</h4>
<div>
<dl>
<dt>
<a href="#ocean_tracer_advect_init">ocean_tracer_advect_init</a>:</dt>
<dd></dd>
<dt>
<a href="#advection_diag_init">advection_diag_init</a>:</dt>
<dd></dd>
<dt>
<a href="#watermass_diag_init">watermass_diag_init</a>:</dt>
<dd></dd>
<dt>
<a href="#gyre_overturn_diagnose_init">gyre_overturn_diagnose_init</a>:</dt>
<dd></dd>
<dt>
<a href="#quicker_init">quicker_init</a>:</dt>
<dd></dd>
<dt>
<a href="#fourth_sixth_init">fourth_sixth_init</a>:</dt>
<dd></dd>
<dt>
<a href="#mdfl_init">mdfl_init</a>:</dt>
<dd></dd>
<dt>
<a href="#mdppm_init">mdppm_init</a>:</dt>
<dd></dd>
<dt>
<a href="#mdmdt_init">mdmdt_init</a>:</dt>
<dd></dd>
<dt>
<a href="#psom_init">psom_init</a>:</dt>
<dd></dd>
<dt>
<a href="#horz_advect_tracer">horz_advect_tracer</a>:</dt>
<dd></dd>
<dt>
<a href="#vert_advect_tracer">vert_advect_tracer</a>:</dt>
<dd></dd>
<dt>
<a href="#horz_advect_tracer_upwind">horz_advect_tracer_upwind</a>:</dt>
<dd></dd>
<dt>
<a href="#horz_advect_tracer_2nd_order">horz_advect_tracer_2nd_order</a>:</dt>
<dd></dd>
<dt>
<a href="#horz_advect_tracer_4th_order">horz_advect_tracer_4th_order</a>:</dt>
<dd></dd>
<dt>
<a href="#horz_advect_tracer_6th_order">horz_advect_tracer_6th_order</a>:</dt>
<dd></dd>
<dt>
<a href="#horz_advect_tracer_quicker">horz_advect_tracer_quicker</a>:</dt>
<dd></dd>
<dt>
<a href="#horz_advect_tracer_quickmom3">horz_advect_tracer_quickmom3</a>:</dt>
<dd></dd>
<dt>
<a href="#vert_advect_tracer_upwind">vert_advect_tracer_upwind</a>:</dt>
<dd></dd>
<dt>
<a href="#vert_advect_tracer_2nd_order">vert_advect_tracer_2nd_order</a>:</dt>
<dd></dd>
<dt>
<a href="#vert_advect_tracer_4th_order">vert_advect_tracer_4th_order</a>:</dt>
<dd></dd>
<dt>
<a href="#vert_advect_tracer_6th_order">vert_advect_tracer_6th_order</a>:</dt>
<dd></dd>
<dt>
<a href="#vert_advect_tracer_quicker">vert_advect_tracer_quicker</a>:</dt>
<dd></dd>
<dt>
<a href="#vert_advect_tracer_quickmom3">vert_advect_tracer_quickmom3</a>:</dt>
<dd></dd>
<dt>
<a href="#advect_tracer_mdfl_sup_b">advect_tracer_mdfl_sup_b</a>:</dt>
<dd></dd>
<dt>
<a href="#advect_tracer_mdfl_sweby_test">advect_tracer_mdfl_sweby_test</a>:</dt>
<dd></dd>
<dt>
<a href="#advect_tracer_mdfl_sweby">advect_tracer_mdfl_sweby</a>:</dt>
<dd></dd>
<dt>
<a href="#advect_tracer_sweby_all">advect_tracer_sweby_all</a>:</dt>
<dd></dd>
<dt>
<a href="#advect_tracer_psom">advect_tracer_psom</a>:</dt>
<dd></dd>
<dt>
<a href="#psom_x">psom_x</a>:</dt>
<dd></dd>
<dt>
<a href="#psom_y">psom_y</a>:</dt>
<dd></dd>
<dt>
<a href="#psom_z">psom_z</a>:</dt>
<dd></dd>
<dt>
<a href="#advect_tracer_mdppm_test">advect_tracer_mdppm_test</a>:</dt>
<dd></dd>
<dt>
<a href="#advect_tracer_mdppm">advect_tracer_mdppm</a>:</dt>
<dd></dd>
<dt>
<a href="#ppm_limit_cw84">ppm_limit_cw84</a>:</dt>
<dd></dd>
<dt>
<a href="#ppm_limit_ifc">ppm_limit_ifc</a>:</dt>
<dd></dd>
<dt>
<a href="#ppm_limit_sh">ppm_limit_sh</a>:</dt>
<dd></dd>
<dt>
<a href="#advect_tracer_mdmdt_test">advect_tracer_mdmdt_test</a>:</dt>
<dd></dd>
<dt>
<a href="#gyre_overturn_diagnose">gyre_overturn_diagnose</a>:</dt>
<dd></dd>
<dt>
<a href="#watermass_diag">watermass_diag</a>:</dt>
<dd></dd>
<dt>
<a href="#compute_adv_diss">compute_adv_diss</a>:</dt>
<dd></dd>
<dt>
<a href="#get_tracer_stats">get_tracer_stats</a>:</dt>
<dd></dd>
<dt>
<a href="#tracer_stats">tracer_stats</a>:</dt>
<dd></dd>
<dt>
<a href="#ocean_tracer_advect_restart">ocean_tracer_advect_restart</a>:</dt>
<dd></dd>
<dt>
<a href="#ocean_tracer_advect_end">ocean_tracer_advect_end</a>:</dt>
<dd></dd>
</dl>
</div>
<br>
<!-- END PUBLIC INTERFACE -->
<a name="PUBLIC ROUTINES"></a>
<hr>
<h4>PUBLIC ROUTINES</h4>
<!-- BEGIN PUBLIC ROUTINES -->
<ol type="a">
<li>
<a name="ocean_tracer_advect_init"></a>
<h4>ocean_tracer_advect_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize the tracer advection module.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advection_diag_init"></a>
<h4>advection_diag_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize the main tracer advection diagnostics. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="watermass_diag_init"></a>
<h4>watermass_diag_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize the watermass diagnostics. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="gyre_overturn_diagnose_init"></a>
<h4>gyre_overturn_diagnose_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize diagnostics and fields for gyre/overturning.

 March 2012 for faster approach:
 russell.fiedler@csiro.au

 Some reorganization
 Stephen.Griffies

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="quicker_init"></a>
<h4>quicker_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize quicker specific fields. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="fourth_sixth_init"></a>
<h4>fourth_sixth_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize the fourth order and sixth order advection fields.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="mdfl_init"></a>
<h4>mdfl_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize mdfl and dst_linear specific fields.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="mdppm_init"></a>
<h4>mdppm_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize mdppm specific fields.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="mdmdt_init"></a>
<h4>mdmdt_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Initialize mdmdt specific fields.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="psom_init"></a>
<h4>psom_init</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Read restart or initialize moments for prather advection
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="horz_advect_tracer"></a>
<h4>horz_advect_tracer</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute horizontal advection of tracers 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="vert_advect_tracer"></a>
<h4>vert_advect_tracer</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute vertical advection of tracers for case 
 with advect_sweby_all=.false.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="horz_advect_tracer_upwind"></a>
<h4>horz_advect_tracer_upwind</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute horizontal advection of tracers from first order upwind.  
 This scheme is positive definite but very diffusive.  
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="horz_advect_tracer_2nd_order"></a>
<h4>horz_advect_tracer_2nd_order</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute horizontal advection of tracers from second order 
 centered differences.  
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="horz_advect_tracer_4th_order"></a>
<h4>horz_advect_tracer_4th_order</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute horizontal advection of tracers from fourth order centered
 differences. 

 WARNING: This code does NOT account for non-uniform grids.   

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="horz_advect_tracer_6th_order"></a>
<h4>horz_advect_tracer_6th_order</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute horizontal advection of tracers from sixth order centered
 differences. 

 WARNING: this code does NOT account for non-uniform grids.   

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="horz_advect_tracer_quicker"></a>
<h4>horz_advect_tracer_quicker</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute horizontal advection of tracers from quicker. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="horz_advect_tracer_quickmom3"></a>
<h4>horz_advect_tracer_quickmom3</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute horizontal advection of tracers from quicker using MOM3 masking. 
 This method has proven useful for reproducing MOM3 results with later MOM.  
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="vert_advect_tracer_upwind"></a>
<h4>vert_advect_tracer_upwind</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute vertical advection of tracers from first order upwind. 
 This scheme is positive definite, but very diffusive. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="vert_advect_tracer_2nd_order"></a>
<h4>vert_advect_tracer_2nd_order</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute vertical advection of tracers from second order centered
 differences. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="vert_advect_tracer_4th_order"></a>
<h4>vert_advect_tracer_4th_order</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute vertical advection of tracers from fourth order centered
 differences. NOTE: this code does not account for non-uniform grids.   
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="vert_advect_tracer_6th_order"></a>
<h4>vert_advect_tracer_6th_order</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute vertical advection of tracers from sixth order centered
 differences. NOTE: this code does not account for non-uniform grids.   
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="vert_advect_tracer_quicker"></a>
<h4>vert_advect_tracer_quicker</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute vertical advection of tracers from quicker.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="vert_advect_tracer_quickmom3"></a>
<h4>vert_advect_tracer_quickmom3</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute vertical advection of tracers from quicker using MOM3 masking.
 This method has proven useful for reproducing MOM3 results with later MOM.  
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advect_tracer_mdfl_sup_b"></a>
<h4>advect_tracer_mdfl_sup_b</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
-------
 NOTE: This is legacy code. It may exhibit problems with limiters 
 that are improperly implemented in the case of generalized vertical level 
 coordinates of MOM. Under certain circumstances, the resulting tracer 
 concentration can exhibit non-monotonic behaviour (i.e., produce extrema).  

 Sept 2011 
 Stephen.Griffies
 Alistair.Adcroft
-------

 Compute tendency due to 3D advection of tracers using a 
 multi-dimensional flux-limited method.  This method differs from 
 other MOM advection methods in the following ways:

 1) Horizontal and vertical advection are combined
 2) Calculations of the three coordinates (Z, X, Y) are performed sequentially as updates
        to the tracer, so that the advection components for X and Y depend on Z and Z,Y
    respectively. This helps limit the flux.
 3) During the update for each direction, the 2nd order Super-B flux limiter is applied.
 4) Flux divergence is included within the calculation to also help limit the flux:
          - During the update for each direction, the divergence in each direction is added.
          - During the overall tendency calculated, the divergence in all three directions 
                 is removed.
 5) All fluxes are functions of the tracer field at the taum1 time step.  This 
    means that this method is ideally suited for the twolevel time stepping scheme,
    in which "taum1=tau", thus enabling twice the tracer time step available for the 
    threelevel scheme. 

The calculation proceeds as follows:

 IMPORTANT NOTE: If this scheme is used at all, it must be used as the option for BOTH
 horizontal and vertical advection.  In the the tracer tendency, it is applied as the 
 horizontal term, but applies to vertical as well, for which case the vertical term in
 the tracer tendency equation is set to zero.

 This scheme was ported to mom4 from the MIT-GCM by John Dunne and Alistair Adcroft  
 during Summer 2003 

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advect_tracer_mdfl_sweby_test"></a>
<h4>advect_tracer_mdfl_sweby_test</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute tendency due to 3D advection of tracers using a multi-dimensional flux-limited
 method.  This method differs from other methods in the following ways:

 1) Horizontal and vertical advection are combined
 2) Calculations of the three coordinates (Z, X, Y) are performed sequentially as updates
        to the tracer, so that the advection components for X and Y depend on Z and Z,Y
        respectively... This helps limit the flux.
 3) During the update for each direction, the 3rd order Sweby flux limiter is applied.
 4) Flux divergence is included within the calculation to also help limit the flux:
          - During the update for each direction, the divergence in each direction is added.
          - During the overall tendency calculated, the divergence in all three directions
                is removed.
 5) All fluxes are functions of the tracer field at the taum1 time step.  This 
    means that this method is ideally suited for the twolevel time stepping scheme,
    in which "taum1=tau", thus enabling twice the tracer time step available for the 
    threelevel scheme. 

 The calculation proceeds as follows:

 IMPORTANT NOTE: If this scheme is used at all, it must be used as the option for BOTH
 horizontal and vertical advection.  In the tracer tendency, it is applied as the 
 horizontal term, but applies to vertical as well, for which case the vertical term in
 the tracer tendency equation is set to zero.

 This scheme was ported to mom4 from the MIT-GCM by John Dunne and Alistair Adcroft  
 during Summer 2003 

 Griffies: 5/27/04
 Optimized by filling 3d arrays prior to sending for mpp_update_domains

 07/11/2007 by Stephen.Griffies
 When the nonlinear limiters are removed (sweby_limiter=0.0), 
 this scheme reduces to a linear direct space-time method 
 (ADVECT_DST_LINEAR).  
 
 This is a test version of the mdfl_sweby scheme. It is not supported for 
 general use. 

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advect_tracer_mdfl_sweby"></a>
<h4>advect_tracer_mdfl_sweby</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

-------
 NOTE: This is a legacy version of the advect_tracer_mdfl_sweby routine. 
 This version may have problems with limiters that are improperly implemented
 in the case of generalized vertical level coordinates of MOM. Consequently,  
 under certain circumstances, the resulting tracer concentration can 
 exhibit non-monotonic behaviour (i.e., produce extrema).  
 This routine was used in various GFDL model configurations. 

 Sept 2011 
 Stephen.Griffies
 Alistair.Adcroft
-------

 Compute tendency due to 3D advection of tracers using a multi-dimensional flux-limited
 method.  This method differs from other methods in the following ways:

 1) Horizontal and vertical advection are combined
 2) Calculations of the three coordinates (Z, X, Y) are performed sequentially as updates
        to the tracer, so that the advection components for X and Y depend on Z and Z,Y
        respectively... This helps limit the flux.
 3) During the update for each direction, the 3rd order Sweby flux limiter is applied.
 4) Flux divergence is included within the calculation to also help limit the flux:
          - During the update for each direction, the divergence in each direction is added.
          - During the overall tendency calculated, the divergence in all three directions
                is removed.
 5) All fluxes are functions of the tracer field at the taum1 time step.  This 
    means that this method is ideally suited for the twolevel time stepping scheme,
    in which "taum1=tau", thus enabling twice the tracer time step available for the 
    threelevel scheme. 

 The calculation proceeds as follows:

 IMPORTANT NOTE: If this scheme is used at all, it must be used as the option for BOTH
 horizontal and vertical advection.  In the tracer tendency, it is applied as the 
 horizontal term, but applies to vertical as well, for which case the vertical term in
 the tracer tendency equation is set to zero.

 This scheme was ported to mom4 from the MIT-GCM by John Dunne and Alistair Adcroft  
 during Summer 2003 

 Griffies: 5/27/04
 Optimized by filling 3d arrays prior to sending for mpp_update_domains
 
 07/11/2007 by Stephen.Griffies
 When the nonlinear limiters are removed (sweby_limiter=0.0), 
 this scheme reduces to a linear direct space-time method 
 (ADVECT_DST_LINEAR).  

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advect_tracer_sweby_all"></a>
<h4>advect_tracer_sweby_all</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

-------
 NOTE: This is routine suffers from the same problems as the 
 advect_tracer_mdfl_sweby routine. Namely, it has problems  
 with limiters that are improperly implemented in the case of generalized 
 vertical level coordinates of MOM. Consequently,  
 under certain circumstances, the resulting tracer concentration can 
 exhibit non-monotonic behaviour (i.e., produce extrema).  
 This routine was used in various GFDL model configurations. It is retained 
 solely to provide bitwise reproducing those earlier configurations. 

 Sept 2011 
 Stephen.Griffies
 Alistair.Adcroft
-------

 Sweby scheme optimized by doing all tracers at once, so 
 can send larger packet to mpp_update_domains.

 This scheme is available ONLY when advecting all tracers with the 
 sweby scheme.

 This scheme CANNOT be called from compute_adv_diss.  
 
 Stephen.Griffies
 June 2004

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advect_tracer_psom"></a>
<h4>advect_tracer_psom</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Compute advective tendency of dzt*rho*tracer concentration using 
 Prather's second order moment method (SOM): 

 Prather, M. J.,"Numerical Advection by Conservation of Second-Order Moments"
 JGR, Vol 91, NO. D6, p 6671-6681, May 20, 1986

 Merryfield and Holloway (2003), "Application of an accurate advection 
 algorithm to sea-ice modelling". Ocean Modelling, Vol 5, p 1-15.

 MOM 3 code by M. Hofmann and M. A. M. Maqueda
 Ported to mom4p0 by Ronald.Pacanowski
 Ported to mom4p1 by Stephen.Griffies

 The preferred limiters are taken from Merryfield and Holloway,
 and generalized by Bill Merryfield for non-constant grid spacing.

 IMPORTANT NOTE: This scheme must be used for BOTH horizontal and
 vertical advection.  In the tracer tendency, it is applied as the 
 horizontal term, but applies to vertical as well, for which case the 
 vertical term in the tracer tendency equation is set to zero.

 NOTE: When using psom_limit_prather=.true., the tracer has a lower 
 bound of zero.  So this limiter IS NOT appropriate for temperature 
 when measured in degrees C. The preferred, and default, limiter
 is from Merryfield and Holloway.  

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="psom_x"></a>
<h4>psom_x</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute i-advective flux using Prather's SOM. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="psom_y"></a>
<h4>psom_y</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Computes j-advective flux using Prather's SOM. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="psom_z"></a>
<h4>psom_z</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Computes k-advective flux using Prather's SOM. 
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advect_tracer_mdppm_test"></a>
<h4>advect_tracer_mdppm_test</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Compute advective tendency of dzt*rho*tracer concentration using 
 multi-dimensional piecewise parabolic method. 
 
 Controlling parameters:
   Tracer%ppm_hlimiter=0  -&gt; No limiting in the horizontal
          ppm_hlimiter=1  -&gt; Full constraint (Colella and Woodward, 1984)
          ppm_hlimiter=2  -&gt; Improved full constraint (Lin, 2004)
          ppm_hlimiter=3  -&gt; Huynh limiter (Huynh, 1996)

          ppm_vlimiter=*  -&gt; as for ppm_hlimit but for the vertical

 Coded by Alistair.Adcroft
 Jan/Feb 2006

 Updated with controlling parameters, April 2006

 This is an unsupported test version of the MDPPM scheme. It is not
 meant for general use. 

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advect_tracer_mdppm"></a>
<h4>advect_tracer_mdppm</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

-------
 NOTE: This is routine may suffer from same problems as the 
 advect_tracer_mdfl_sweby routine. Namely, it has problems  
 with limiters that are improperly implemented in the case of generalized 
 vertical level coordinates of MOM. Consequently,  
 under certain circumstances, the resulting tracer concentration can 
 exhibit non-monotonic behaviour (i.e., produce extrema).  

 Sept 2011 
 Stephen.Griffies
 Alistair.Adcroft
-------

 Compute advective tendency of dzt*rho*tracer concentration using 
 multi-dimensional piecewise parabolic method. 
 
 Controlling parameters:
   Tracer%ppm_hlimiter=0  -&gt; No limiting in the horizontal
          ppm_hlimiter=1  -&gt; Full constraint (Colella and Woodward, 1984)
          ppm_hlimiter=2  -&gt; Improved full constraint (Lin, 2004)
          ppm_hlimiter=3  -&gt; Huynh limiter (Huynh, 1996)

          ppm_vlimiter=*  -&gt; as for ppm_hlimit but for the vertical

 Coded by Alistair.Adcroft
 Jan/Feb 2006

 Updated with controlling parameters, April 2006

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="ppm_limit_cw84"></a>
<h4>ppm_limit_cw84</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Kernel to limit the edge values for PPM following Colella and Woodward, 1984
 
 Coded by Alistair.Adcroft
 Apr 2006

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="ppm_limit_ifc"></a>
<h4>ppm_limit_ifc</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Kernel to limit the edge values for PPM using the Improved Full Constraint
 (IFC) of Lin, 2004.
 
 Coded by Alistair.Adcroft
 Apr 2006

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="ppm_limit_sh"></a>
<h4>ppm_limit_sh</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Kernel to limit the edge values for PPM following the monotonicity-
 preserving approach of Suresh and Huynh, 1997.
 
 Coded by Alistair.Adcroft
 Apr 2006

 </dd>
<br>
<br>
<dt>
<b>NOTE</b>
</dt>
<dd>
 About efficiency: ppm_limit_sh() is not as efficient as it would be if
 we wrote a s/r for each direction. The pre-calculation of d1m, d1p, d1mm and
 d1pp duplicates operations and would be much faster if d1m was replaced
 by d1p(i+1). However, in order to re-use this limiter for the all directions
 (to simplify debugging) I have opted for the less efficient form for now. - AJA
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="advect_tracer_mdmdt_test"></a>
<h4>advect_tracer_mdmdt_test</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Compute advective tendency of dzt*rho*tracer concentration using 
 multi-dimensional piecewise parabolic method. 
 
 Controlling parameters:
   Tracer%mdt_scheme=0    -&gt; 7th order FV, unlimited (Daru &amp; Tenaud, 2004)
          mdt_scheme=1    -&gt; 7th order FV, TVD limiter
          mdt_scheme=2    -&gt; 7th order FV, MP limiter
          mdt_scheme=3    -&gt; 7th order MP, 4th order TVD, FCT combination (Adcroft, 2011)

 Coded by Alistair.Adcroft
 Aug/Sep 2011

 This code is unsupported test code, which is not meant for general use.  

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="gyre_overturn_diagnose"></a>
<h4>gyre_overturn_diagnose</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Diagnose tracer transport according to zonal mean and 
 deviations from zonal mean. 

 We allow for the use of a basin mask so that the zonal means
 are performed over the global domain and each of five other
 basins.  If no basin mask is read, then assume global domain 
 used to define the zonal means. 
 
 []=zonal mean; *=deviation from zonal mean

 V = rho_dzt dxt T, with rho=rho0 for Boussinesq 

 int [V T]   = total advective 
 int [V][T]  = overturning
 int V* T*   = gyre

 This routine is much faster than the older routine gyre_overturn_diagnose_old.

 In this version, we compute partial zonal sums locally and then perform 
 a "global" sum over a restricted set of pes. 
 This approach results in slightly different answers at the 
 REAL(8) level. However, differences should be negligible for diagnostic 
 purposes at the REAL(4) level. 
 
 We require no global arrays here, and redundant computation is eliminated.

 Note that if advect_sweby_all is used we cannot do this calculation since we
 don not have flux_y, except for the last tracer computed.
 The zonal mean could be computed within the routine or flux_y itself could 
 be stored in a 3D arrays. 
 
 original approach 
 Stephen.Griffies
 May 2007

 optimization by removing global arrays 
 russell.fiedler@csiro.au
 March 2012

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="watermass_diag"></a>
<h4>watermass_diag</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute watermass diagnostics associated with resolved flow
 advection of temperature and salinity.
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="compute_adv_diss"></a>
<h4>compute_adv_diss</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>

 Compute the dissipation due to advection truncation errors. 
 This diagnostic requires computation of advection operator acting
 on the squared tracer concentration. 

 NOTE: This scheme isolates the dissipation from trucation errors
 in advection ONLY for the following vertical coordinates:
 1/ geopotential: for all k-levels, except for k=1 
 (due to undulating surface height)
 2/ pressure: for all k-levels, except for k=kmt
 (due to undulating bottom pressure)

 NOTE: For the Quicker advection scheme, we assume the preferred
 two_level time scheme is used here, so that taum1=tau.  

 NOTE: If PSOM is used for temp or salt, then we MUST also enable 
 a new passive tracer in the field table, with name 
 passive_temp_sq and passive_salt_sq.  This extra tracer is 
 used for diagnostics alone, and is required due to the extra
 moment fields used for computing the PSOM tendency. 
 If PSOM is used for another tracer besides temp or salt, then
 some extra code needs to be written inside ocean_passive.F90,
 emulating the work done for temp and salt. 

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="get_tracer_stats"></a>
<h4>get_tracer_stats</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Compute the upper/lower values of a 3D field, returning values via arguments
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="tracer_stats"></a>
<h4>tracer_stats</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Check the upper/lower values of a 3D field fall between speficied bounds
 reporting points that fall outside. Bring model down uncleanly if bounds are
 exceeded.

 NOTE: This is a debugging tool and not for normal use.

 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="ocean_tracer_advect_restart"></a>
<h4>ocean_tracer_advect_restart</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
  Write out restart files registered through register_restart_file
 </dd>
<br>
<br>
</dl>
</li>
<li>
<a name="ocean_tracer_advect_end"></a>
<h4>ocean_tracer_advect_end</h4>
<dl>
<dt>
<b>DESCRIPTION</b>
</dt>
<dd>
 Write the PSOM moments for restarts.  
 </dd>
<br>
<br>
</dl>
</li>
</ol>
<!-- END PUBLIC ROUTINES -->
<a name="PUBLIC TYPES"></a>
<!-- BEGIN PUBLIC TYPES -->
<!-- END PUBLIC TYPES --><a name="NAMELIST"></a>
<hr>
<h4>NAMELIST</h4>
<!-- BEGIN NAMELIST -->
<div>
<b>&amp;ocean_tracer_advect_nml</b>
<br>
<br>
<div>
<dl>
<dt>
<tt>limit_with_upwind</tt>
</dt>
<dl>
  If true, will compute tracer fluxes entering a cell using upwind 
  if the tracer value is outside a specified range. Implemented
  only for quick at this time. This is an ad hoc and incomplete attempt
  to maintain monotonicity with the quicker scheme.  
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>advect_sweby_all</tt>
</dt>
<dl>
  For running all tracers with sweby, thereby utilizing a bitwise same
  routine that reorganizes loops and can be faster for certain configurations.  
  Default advect_sweby_all=.false.
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>zero_tracer_advect_horz</tt>
</dt>
<dl>
  For debugging.  Set to .true. to turn off horizontal advection.  
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>zero_tracer_advect_vert</tt>
</dt>
<dl>
  For debugging.  Set to .true. to turn off vertical advection.  
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>psom_limit_prather</tt>
</dt>
<dl>
  For running with the original Prather limiter for the PSOM scheme.
  The limiter is positive definite, but not monotonic.  This limiter
  is NOT recommended for most applications.  The default is 
  psom_limit_prather=.false., since we prefer to use the limiter 
  from Merryfield and Holloway (2003).
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>debug_this_module</tt>
</dt>
<dl>
  For debugging 
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>write_a_restart</tt>
</dt>
<dl>
  Set true to write a restart.  False setting only for rare 
  cases where wish to benchmark model without measuring the cost
  of writing restarts and associated chksums.  
  Default is write_a_restart=.true. 
  <br>
<span class="type">[logical]</span>
</dl>
<dt>
<tt>read_basin_mask</tt>
</dt>
<dl>
  For reading in a mask that selects regions of the domain 
  for performing gyre and overturning diagnostics. 
  The basin-mask convention used at GFDL has 
  Southern=1.0,Atlantic=2.0,Pacific=3.0,Arctic=4.0,Indian=5.0
  Default read_basin_mask=.false., whereby basin_mask
  is set to tmask(k=1). 
  <br>
<span class="type">[logical]</span>
</dl>
</dl>
</div>
</div>
<br>
<!-- END NAMELIST -->
<a name="PUBLIC CODE"></a>
<!-- BEGIN PUBLIC CODE -->
<!-- END PUBLIC CODE --><a name="REFERENCES"></a>
<hr>
<h4>REFERENCES</h4>
<!-- BEGIN REFERENCES -->
<div>
<ol>
<li>
 S.-J. Lin
 A "Vertically Lagrangian" Finite-Volume Dynamical Core for Global Models
 Month. Weather Rev. (2004) 132, 2293-2307
 (Appendix B)
</li>
<li>
 H.T. Huynh
 Schemes and Constraints for advection
 15th Intern. Conf. on Numeric. Meth. in Fluid Mech., Springer (1997)
</li>
<li>
 Colella P. and P.R. Woodward
 The piecewise parabloic method (PPM) for gasdynamical simulations
 J. Comput. Phys. (1984) 54, 174-201
</li>
<li>
 A. Suresh and H.T. Huynh
 Accurate Monotonicity-Preserving Schemes with Runge-Kutta Time Splitting
 J. Comput. Phys. (1997) 136, 83-99
</li>
<li>
 V. Daru and  C. Tenaud
 High order one-step monotonicity-preserving schemes for unsteady
 compressible flow calculations.
 J. Comp. Phys. (2004) 193, 563-594
</li>
<li>
 R.C. Easter
 Two modified versions of Botts positive-definite numerical advection scheme.
 Month. Weath. Rev. (1993) 121, 297-304
</li>
<li>
 Prather, M. J.,"Numerical Advection by Conservation of Second-Order Moments"
 JGR, Vol 91, NO. D6, p 6671-6681, May 20, 1986
</li>
<li>
 Merryfield and Holloway (2003), "Application of an accurate advection
 algorithm to sea-ice modelling". Ocean Modelling, Vol 5, p 1-15.
</li>
<li>
 Hundsdorder and Trompert (1994), "Method of lines and 
 direct discretization: a comparison for linear 
 advection", Applied Numerical Mathematics,
 pages 469--490.
</li>
<li>
 Sweby (1984): "High-resolution schemes using flux 
 limiters for hyperbolic conservation laws", 
 SIAM Journal of Numerical Analysis, vol. 21
 pages 995-1011. 
</li>
</ol>
</div>
<br>
<!-- END REFERENCES -->
<hr>
<div align="right">
<font size="-1"><a href="#TOP">top</a></font>
</div>
</body>
</html>
